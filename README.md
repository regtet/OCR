# OCR

**OCR 识别与匹配**

---

## 📘 网页说明

**作用：**  
对两组图片（A 为模板、B 为待重命名）进行 OCR 识别与匹配，将 B 重命名为对应 A 的名字，并支持批量下载。

> ⚠️ 注意：本项目的 OCR 功能依赖百度 OCR 服务（需要 API Key），仅供个人使用，所以没有共享，请自行申请，百度ocr每个账号都有免费1000额度。

---

![OCR](./image.png)

---

## 🔹 主要功能

### 文件导入

* A/B 两组独立选择或拖拽导入。
* 支持多次追加上传（不清空已有列表）。
* 列表中可删除单个图片。

### 识别（OCR）

* A/B 组可同时开始识别。
* 仅识别未识别或上次失败/未识别到文字的图片（已成功的不重复识别）。
* 并发处理：并发度 2，并带全局 QPS 频控（默认每秒最多 2 个请求，可调 1–10）。
* 自动重试：针对 QPS 限制与网络异常，内置退避/重试策略。

### 匹配与重命名

* **自动匹配：** 仅对未匹配的 B，要求与 A 尺寸一致；用文本相似度比较，达到“相似度阈值”才匹配成功。
* **相似度阈值：** 0–1 可调（默认 0.5），OCR 完成后拖动滑块会即时重算自动匹配（保留手动匹配结果）。
* **手动匹配：** 点击选择 A 与 B（再次点击可取消选中）；当尺寸不符时，“确认手动匹配”按钮禁用。
* **冲突处理：** 若产生同名冲突，会将冲突的 B 回退为未匹配状态，并改名为 `unmatched_...`。

---

## 💡 界面与交互

* **预览网格：** 显示缩略图、OCR 文本、分辨率、匹配状态。
  * A 组：显示是否被匹配。
  * B 组：显示是否已匹配。
* **尺寸提示：** 选择 A 时，B 左上角显示“尺寸匹配/尺寸不符”提示。
* **大图预览：** 双击图片可查看大图，展示状态、分辨率、OCR 文本、置信度、相似度等。
* **顶部统计：** 动态显示 A 数量、B 数量、已匹配与未匹配数量。

---

## 📦 下载与重置

* **批量单张下载：** 逐个触发浏览器下载已匹配的 B。
* **批量 ZIP 下载：** 将已匹配的 B 打包下载。
* **重置：** 清空列表、选中状态、日志、文件输入与统计，关闭预览并重置内部状态。

---

## ⚙️ 依赖与后端

**前端依赖：**

* `string-similarity`（文本相似度计算）
* `jszip`（ZIP 打包下载）

**后端接口：**  

> 本项目的 OCR 功能通过本地 Node.js 代理服务访问百度 OCR API。请自行申请百度 OCR API Key 使用。

* POST `/ocr`  
  - 请求参数：
    ```json
    {
      "imageBase64": "..." // 图片 Base64 编码
    }
    ```
  - 返回：
    ```json
    {
      "words_result": [...],
      "log_id": ...,
      ...
    }
    ```
* 代理服务：`server.js`  
  - 启动方式：
    ```bash
    node server.js
    ```
  - 默认监听端口：3000 (`http://localhost:3000`)  
  - 包含 QPS 控制与网络重试策略

> ⚠️ 提醒：OCR 服务的 API Key 为私密信息，请勿在公共仓库中共享。

---

## 📌 使用说明

1. 下载本项目并放置 `index.html` 与 `server.js` 在同一目录。  
2. 准备好你的百度 OCR API Key 并在 `server.js` 中配置。  
3. 启动 Node.js 服务：
    ```bash
    node server.js
    ```
4. 打开 `index.html`，导入 A/B 两组图片，即可开始 OCR 识别与匹配操作。  
5. 操作完成后可下载匹配后的 B 图片，或者打包下载 ZIP 文件。


# 🚨 OCRPlus 已停止维护
> ocrplus.html为旧版 OCRPlus（增强版 OCR 工具）。  
> 从即日起，OCRPlus 不再维护与更新，后续功能与修复将 **全部以[OCR]为主 **。  
> 请根据自己需要进行使用 ，以获得更好的性能与体验。

---

# OCRPlus — 图片识别与智能匹配工具

---
![OCR](./ocrplus.png)

## 📘 核心用途
将两组图片（A 组模板、B 组待重命名）进行 **OCR 识别与智能匹配**，并提供后续 **批量格式转换与下载** 的一站式处理。

---

## ⚙️ 主要功能

### 一、文件管理与预览
- A/B 两组各自上传（点击或拖拽），可多次追加；
- 网格预览缩略图、文件名、OCR 文本、分辨率；
- 支持删除单张；
- 顶部实时统计 A/B 数量、已匹配 / 未匹配 状态。

---

### 二、OCR 识别与匹配

#### 🔹 自动识别
- 一键 “开始 OCR 识别”：依次识别 A → B（仅识别文本为空的项），带进度条与日志；
- 自动匹配规则：
  - 仅匹配尺寸一致的 B → A；
  - 用 `string-similarity` 比较 OCR 文本；
  - 匹配阈值固定为 0.5。

#### 🔹 手动匹配
- 需 A、B 各选一张且尺寸一致；
- 按钮高亮与禁用会随选择状态实时更新。

#### ⚠️ 冲突处理
- 如重名会回退冲突项为未匹配；
- 清空其匹配信息。

---

### 三、批量格式转换与下载

#### 🔧 转换面板
- 选择目标格式：`jpg` / `png` / `webp` / `avif` / `ico` 等；
- 压缩质量可调；
- 重命名规则：
  - 保持原名；
  - 匹配名；
  - 时间戳；
  - 顺序号。

#### 📦 下载方式
- 批量转换后生成结果列表；
- 可单个下载、全部下载、或打包 ZIP 下载。

---

## 🖥️ 界面与体验
- 分步骤工作流（上传 → 识别/匹配 → 转换/下载）；
- 可视化进度条与详细日志；
- 选中态、匹配态、未匹配态清晰可见；
- B 组对已选 A 显示“尺寸匹配 / 尺寸不符”指示。

---

## 🔗 依赖与后端

### 前端依赖
- `string-similarity`
- `jszip`

### OCR 接口
- `POST http://0.0.0.0:3000/ocr`
- 内含简单 QPS / 网络重试（非全局节流）

---

## 🔍 与 ocr.html 的差异
- 增加了 **格式转换整套流程与 UI**（质量滑块、重命名规则、结果面板）；
- 识别流程为 **顺序进度化**（非并发 / QPS 动态控制）；
- 手动匹配仅在尺寸一致时可用；
- 未包含“强制手动匹配”与阈值 / QPS 滑块。
