# OCR

**OCR 识别与匹配**

---

## 📘 网页说明

**作用：** 对两组图片（A 为模板、B 为待重命名）进行 OCR 识别与匹配，将 B 重命名为对应 A 的名字，并支持批量下载。

---

## 🔹 主要功能

### 文件导入

* A/B 两组独立选择或拖拽导入。
* 支持多次追加上传（不清空已有列表）。
* 列表中可删除单个图片。

### 识别（OCR）

* A/B 组可同时开始识别。
* 仅识别未识别或上次失败/未识别到文字的图片（已成功的不重复识别）。
* 并发处理：并发度 2，并带全局 QPS 频控（默认每秒最多 2 个请求，可调 1–10）。
* 自动重试：针对 QPS 限制与网络异常，内置退避/重试策略。

### 匹配与重命名

* **自动匹配：** 仅对未匹配的 B，要求与 A 尺寸一致；用文本相似度比较，达到“相似度阈值”才匹配成功。
* **相似度阈值：** 0–1 可调（默认 0.5），OCR 完成后拖动滑块会即时重算自动匹配（保留手动匹配结果）。
* **手动匹配：** 点击选择 A 与 B（再次点击可取消选中）；当尺寸不符时，“确认手动匹配”按钮禁用。
* **冲突处理：** 若产生同名冲突，会将冲突的 B 回退为未匹配状态，并改名为 `unmatched_...`。

---

## 💡 界面与交互

* **预览网格：** 显示缩略图、OCR 文本、分辨率、匹配状态。

  * A 组：显示是否被匹配。
  * B 组：显示是否已匹配。
* **尺寸提示：** 选择 A 时，B 左上角显示“尺寸匹配/尺寸不符”提示。
* **大图预览：** 双击图片可查看大图，展示状态、分辨率、OCR 文本、置信度、相似度等。
* **顶部统计：** 动态显示 A 数量、B 数量、已匹配与未匹配数量。

---

## 📦 下载与重置

* **批量单张下载：** 逐个触发浏览器下载已匹配的 B。
* **批量 ZIP 下载：** 将已匹配的 B 打包下载。
* **重置：** 清空列表、选中状态、日志、文件输入与统计，关闭预览并重置内部状态。

---

## ⚙️ 依赖与后端

**前端依赖：**

* `string-similarity`（文本相似度计算）
* `jszip`（ZIP 打包下载）

**后端接口：**

* `POST http://localhost:3000/ocr`

  * 返回 OCR 文本与置信度。
  * 前端内置 QPS 控制与网络重试处理。
